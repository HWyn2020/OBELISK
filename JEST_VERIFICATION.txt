PASS tests/enterprise-2-business.test.js (16.446 s)
    ✓ TL-001: Calculate options returns 3 tiers (56 ms)
    ✓ TL-002: Create contract with valid params (10 ms)
    ✓ TL-003: Expired contract cannot be activated (12 ms)
    ✓ TL-004: Cannot create contract with negative amount (5 ms)
    ✓ TL-005: Cannot create contract with zero amount (5 ms)
    ✓ TL-006: Contract cancel returns to previous state (7 ms)
    ✓ TL-007: Status query on active contract (7 ms)
    ✓ MESH-001: Cannot add duplicate node (1 ms)
    ✓ MESH-002: Cannot open corridor to self (1 ms)
    ✓ MESH-003: Payment fails on non-existent corridor (1 ms)
    ✓ MESH-004: Payment to non-existent node fails (1 ms)
    ✓ MESH-005: Settlement with zero obligations succeeds cleanly (1 ms)
    ✓ MESH-006: Node isolation — removed node unreachable (4 ms)
    ✓ MESH-007: Full mesh connectivity — all pairs reachable (5 ms)
    ✓ MESH-008: 10-node mesh handles payment routing (7 ms)
    ✓ NODE-001: Unregistered vault cannot make outbound payment (4 ms)
    ✓ NODE-002: Tampered proof rejected by node (2 ms)
    ✓ NODE-003: Replayed proof rejected (nonce reuse) (2 ms)
    ✓ NODE-004: Commitment from unknown sender rejected (1 ms)
    ✓ NODE-005: Node jurisdiction is immutable after creation (1 ms)
    ✓ NODE-006: 100 sequential vault registrations (38 ms)
    ✓ VAULT-001: Cannot access signing key after lock (1 ms)
    ✓ VAULT-002: Identity commitment is deterministic for same data (2 ms)
    ✓ VAULT-003: Proof counter never decrements (3 ms)
    ✓ VAULT-004: Cannot store identity without unlocking
    ✓ VAULT-005: Proof with wrong recipientNodeId rejected at destination (2 ms)
    ✓ VAULT-006: Multiple identities on same vault not possible (1 ms)
    ✓ VAULT-007: Proof contains vaultId but not identity data (1 ms)
    ✓ VAULT-008: Vault ID format is UUID
    ✓ FX-001: Rate reciprocal consistency (EUR→USD × USD→EUR ≈ 1) (8 ms)
    ✓ FX-002: Spread is always positive (never benefits customer) (19 ms)
    ✓ FX-003: Convert preserves amount direction (always positive output) (12 ms)
    ✓ FX-004: Same-currency conversion is identity (4 ms)
    ✓ FX-005: JPY has 0 decimal places (minor units) (5 ms)
    ✓ FX-006: FX rate staleness — cached rates have timestamps (4 ms)
    ✓ FX-007: 50 concurrent rate requests don't crash (5041 ms)
    ✓ FX-008: Unsupported currency pair throws (4 ms)
    ✓ CHAIN-001: Onboard → Pay → Settle full lifecycle (5013 ms)
    ✓ CHAIN-002: Multiple customers, cross-payments, settlement (4984 ms)
    ✓ CHAIN-003: Customer does max allowed then gets rejected on next (15 ms)
    ✓ CHAIN-004: Idempotent payment — same key returns same result (8 ms)
    ✓ CHAIN-005: Payment to all 5 jurisdictions from single customer (20 ms)
    ✓ CHAIN-006: Rapid onboard-pay-onboard-pay cycle (10 iterations) (50 ms)
    ✓ ORCH-001: Payment with missing senderCustomerId (5 ms)
    ✓ ORCH-002: Payment with non-existent customer (4 ms)
    ✓ ORCH-003: Payment with non-existent receiver node (8 ms)
    ✓ ORCH-004: Onboard with minimum required fields only (6 ms)
    ✓ ORCH-005: Onboard with extreme unicode name (4 ms)
    ✓ ORCH-006: settleAll returns consistent structure (4 ms)
    ✓ ORCH-007: getCustomerStatus for valid vs invalid ID (4 ms)
    ✓ ORCH-008: Payment with amount=0.01 (minimum realistic) (7 ms)
    ✓ ORCH-009: Payment with very large amount (5 ms)
    ✓ ORCH-010: Payment purpose field accepts all valid strings (30 ms)
    ✓ PE-001: Create with all required fields (4 ms)
    ✓ PE-002: Create with missing amount — caught at validation (4 ms)
    ✓ PE-003: Create with missing currency — caught at validation (4 ms)
    ✓ PE-004: Create with missing sender (3 ms)
    ✓ PE-005: Create with missing beneficiary (5 ms)
    ✓ PE-006: Get payment returns correct data (6 ms)
    ✓ PE-007: Validate catches invalid IBAN (4 ms)
    ✓ PE-008: Sanctioned name caught during screening (3 ms)
    ✓ PE-009: Quote returns rate and converted amount (7 ms)
    ✓ PE-010: Full lifecycle produces settlement reference (6 ms)
    ✓ GDPR-001: PII never crosses node boundary in proof (1 ms)
    ✓ GDPR-002: Encrypted PII is not reversible without key
    ✓ GDPR-003: Identity commitment is one-way (cannot reverse to PII) (1 ms)
    ✓ GDPR-004: Vault stores PII locally, never transmits (1 ms)
    ✓ GDPR-005: Data minimization — proof only contains needed claims (3 ms)
    ✓ GDPR-006: Cross-border proof does not contain jurisdiction-specific data (3 ms)
    ✓ GDPR-007: Encryption contexts enforce purpose limitation (1 ms)
    ✓ GDPR-008: Vault data isolated per customer (no cross-contamination) (12 ms)
    ✓ COMBO-001: Payment with matching send/receive currency (9 ms)
    ✓ COMBO-002: Every supported currency as send (12 ms)
    ✓ COMBO-003: 5 different customers to same node (26 ms)
    ✓ COMBO-004: Same customer to 4 different nodes (21 ms)
    ✓ COMBO-005: Onboard from every supported country (16 ms)
    ✓ COMBO-006: Payment amounts at every order of magnitude (28 ms)
    ✓ ENCM-001: Each context derives unique key
    ✓ ENCM-002: Context mismatch always fails decryption (1 ms)
    ✓ ENCM-003: 1000 unique nonces in sequence (20 ms)
    ✓ ENCM-004: Encrypt/decrypt round-trip for every data type (2 ms)
PASS tests/enterprise-1-owasp.test.js (10.749 s)
    ✓ BOLA-001: Customer A cannot view Customer B's vault status (10 ms)
    ✓ BOLA-002: Cannot pay from another customer's account (16 ms)
    ✓ BOLA-003: UUID enumeration — random IDs don't resolve (11 ms)
    ✓ BOLA-004: Sequential ID guessing doesn't work (12 ms)
    ✓ AUTH-001: Locked vault cannot generate proofs
    ✓ AUTH-002: Wrong passphrase doesn't unlock same keys (2 ms)
    ✓ AUTH-003: Vault lock actually clears sensitive material (1 ms)
    ✓ AUTH-004: Expired proof rejected by trust node (2 ms)
    ✓ AUTH-005: Brute force passphrase lockout
    ✓ AUTH-006: Empty passphrase rejected
    ✓ AUTH-007: Null/undefined passphrase rejected (1 ms)
    ✓ PROP-001: Payment response never contains raw PII (13 ms)
    ✓ PROP-002: Customer status never reveals identity (5 ms)
    ✓ PROP-003: Proof attestations are booleans, never contain data values (3 ms)
    ✓ PROP-004: Encrypted fields cannot be decrypted without key
    ✓ PROP-005: Mass assignment — extra fields in onboarding ignored (5 ms)
    ✓ RESC-001: 100 rapid onboardings don't crash (97 ms)
    ✓ RESC-002: 20 concurrent payments don't corrupt state (5039 ms)
    ✓ RESC-003: Proof rate limit enforced per vault (3 ms)
    ✓ RESC-004: Encryption engine handles 5000 ops without memory leak (127 ms)
    ✓ FUNC-001: settleAll is a privileged operation (no customer gating) (5 ms)
    ✓ FUNC-002: Trust node registration requires valid public key
    ✓ FUNC-003: Cannot forge vault registration (1 ms)
    ✓ FLOW-001: Rapid re-onboarding same identity (account farming) (14 ms)
    ✓ FLOW-002: Payment to every available node (corridor scanning) (26 ms)
    ✓ FLOW-003: Structuring detection — 9 payments just below €10K threshold (33 ms)
    ✓ STATE-001: Happy path — all valid transitions in order (5 ms)
    ✓ STATE-002: Cannot skip VALIDATED → CONFIRMED (bypass screening) (3 ms)
    ✓ STATE-003: Cannot process CREATED payment (skip everything) (3 ms)
    ✓ STATE-004: COMPLETED payment cannot be re-processed (6 ms)
    ✓ STATE-005: Cancel from every cancellable state (7 ms)
    ✓ STATE-006: Cancel from COMPLETED or PROCESSING fails (7 ms)
    ✓ STATE-007: Nonexistent payment ID returns error (3 ms)
    ✓ STATE-008: State history is append-only and complete (7 ms)
    ✓ BOUND-001: Amount boundaries (payment engine) (5 ms)
    ✓ BOUND-002: Over-max amount rejected at validation (4 ms)
    ✓ BOUND-003: All supported currency pairs produce valid quotes (5053 ms)
    ✓ BOUND-004: IBAN validation — valid IBANs from 10 countries (4 ms)
    ✓ BOUND-005: Unicode in every string field — no crashes (13 ms)
    ✓ BOUND-006: KYC tier limits enforced at exact boundaries (5 ms)
    ✓ BOUND-007: AML threshold boundary — exactly €10,000 (4 ms)
    ✓ SANC-001: Known sanctioned names blocked (1 ms)
    ✓ SANC-002: Common names not false-positive blocked (1 ms)
    ✓ SANC-003: Phonetic matching — similar-sounding names (1 ms)
    ✓ SANC-004: Empty and whitespace-only names handled
    ✓ SANC-005: Very long names handled (>1000 chars)
    ✓ SANC-006: Special characters in names (2 ms)
    ✓ ENC-001: Every context produces isolated keys (1 ms)
    ✓ ENC-002: Decrypt with wrong context fails for all combinations (1 ms)
    ✓ ENC-003: Empty string encryption correctly rejected
    ✓ ENC-004: Very large payload encryption (1 ms)
    ✓ ENC-005: Binary data in string form (1 ms)
    ✓ ENC-006: Master key rotation — old keys can't decrypt new data (1 ms)
    ✓ ENC-007: Ciphertext format validation — reject garbage (1 ms)
    ✓ KYC-001: All 4 tiers have defined limits (3 ms)
    ✓ KYC-002: Higher tiers allow larger transactions (3 ms)
    ✓ KYC-003: Invalid tier name handled gracefully (3 ms)
    ✓ KYC-004: Risk scoring produces bounded values (6 ms)
    ✓ AML-001: Clean transaction passes
    ✓ AML-002: High-risk jurisdiction flagged (1 ms)
    ✓ AML-003: Large amount triggers enhanced scrutiny
    ✓ AML-004: Rapid succession pattern (velocity) (1 ms)
    ✓ AML-005: Round amounts pattern (structuring indicator)
    ✓ AML-006: Multiple beneficiary countries (smurfing)
    ✓ AML-007: Empty history doesn't crash
    ✓ AML-008: Null/undefined fields in transaction don't crash (1 ms)
PASS tests/security-timelock.test.js (7.292 s)
    ✓ SQ-001: Setup requires all 7 preset answers (519 ms)
    ✓ SQ-002: Missing preset answer rejected (23 ms)
    ✓ SQ-003: Exactly 2 custom questions required (1 ms)
    ✓ SQ-004: Custom question must be at least 10 characters
    ✓ SQ-005: Answer must be at least 2 characters (1 ms)
    ✓ SQ-006: Customer ID required (1 ms)
    ✓ SQ-007: hasQuestionsConfigured returns correct status (543 ms)
    ✓ SQ-008: getQuestionCount returns 9 after setup (528 ms)
    ✓ SQ-009: Setup with encryption engine encrypts at rest (522 ms)
    ✓ SQ-010: Null/undefined params rejected
    ✓ CH-001: Generate PASSWORD_CHANGE challenge (3 questions) (1 ms)
    ✓ CH-002: Generate TIMELOCK_CREATE challenge (3 questions)
    ✓ CH-003: Generate ACCOUNT_RECOVERY challenge (5 questions) (1 ms)
    ✓ CH-004: Invalid challenge type rejected (2 ms)
    ✓ CH-005: Unconfigured customer rejected
    ✓ CH-006: Questions are randomized (statistical test) (2 ms)
    ✓ CH-007: Challenge questions never include answers (1 ms)
    ✓ CH-008: Challenge includes attempts remaining (1 ms)
    ✓ VER-001: Correct answers pass verification (169 ms)
    ✓ VER-002: Wrong answers fail verification (168 ms)
    ✓ VER-003: Missing answers fail verification (1 ms)
    ✓ VER-004: Challenge token is one-time use (171 ms)
    ✓ VER-005: Invalid challenge token rejected (1 ms)
    ✓ VER-006: Answer normalization — case insensitive (168 ms)
    ✓ VER-007: Results don't reveal which questions were wrong (168 ms)
    ✓ LOCK-001: Lockout after 5 consecutive failures (839 ms)
    ✓ LOCK-002: Successful answer resets consecutive counter (1036 ms)
    ✓ LOCK-003: Attempts remaining decrements correctly (693 ms)
    ✓ LOCK-IN-001: Default lock-in is 48 hours (4 ms)
    ✓ LOCK-IN-002: Cancel blocked during lock-in (8 ms)
    ✓ LOCK-IN-003: Cancel succeeds after lock-in expires (2 ms)
    ✓ LOCK-IN-004: Lock-in period configurable (2 ms)
    ✓ LOCK-IN-005: Error message includes remaining hours (3 ms)
    ✓ CAP-001: NEW customer limited to 1 contract/day (2 ms)
    ✓ CAP-002: ESTABLISHED customer gets 3/day (10 ms)
    ✓ CAP-003: TRUSTED customer gets 5/day (8 ms)
    ✓ CAP-004: Different customers have independent limits (3 ms)
    ✓ CAP-005: Invalid trust tier rejected (1 ms)
    ✓ CAP-006: Error message includes tier and usage info (2 ms)
    ✓ CAP-007: Trust tiers have correct max values
    ✓ FEE-001: Contract fee is 1.2% + $1 (2 ms)
    ✓ FEE-002: Contract fee marked non-refundable (2 ms)
    ✓ FEE-003: Cancellation forfeits contract fee (2 ms)
    ✓ FEE-004: Small amount still incurs $1 flat fee (2 ms)
    ✓ FEE-005: Fee currency matches send currency (2 ms)
    ✓ FEE-006: Contract fee defaults are correct
    ✓ SEAL-001: Contract object has no derivativeProfile field (1 ms)
    ✓ SEAL-002: Client view strips sealed data completely (2 ms)
    ✓ SEAL-003: Internal getDerivativeProfile works (2 ms)
    ✓ SEAL-004: Encrypted derivative profile with EncryptionEngine (2 ms)
    ✓ SEAL-005: getDerivativeProfile returns null for contract without profile
    ✓ CONST-001: MIN_LOCK_IN_HOURS is 48
    ✓ CONST-002: All trust tiers defined
    ✓ CONST-003: CONTRACT_FEE values
    ✓ CONST-004: Preset questions count is 7
    ✓ CONST-005: Custom question slots is 2 (1 ms)
    ✓ CONST-006: All preset questions have id and text
PASS tests/penetration-r2.test.js (5.507 s)
    ✓ FUZZ-001: Type confusion — string where number expected in amount (5 ms)
    ✓ FUZZ-002: Boundary values — IEEE 754 edge cases in amounts (1 ms)
    ✓ FUZZ-003: Null byte injection in string fields (3 ms)
    ✓ FUZZ-004: Currency code fuzzing — invalid ISO 4217 (1 ms)
    ✓ FUZZ-005: Email field fuzzing — RFC 5321 edge cases (15 ms)
    ✓ FUZZ-006: Country code fuzzing — non-ISO 3166-1 alpha-2 (18 ms)
    ✓ RACE-001: Double-spend — concurrent identical payments (12 ms)
    ✓ RACE-002: Concurrent vault unlock/lock — operation safety (1 ms)
    ✓ RACE-003: Parallel onboarding — same identity, two attempts (5 ms)
    ✓ RACE-004: TOCTOU on KYC limits — check vs. deduction gap (10 ms)
    ✓ RACE-005: Concurrent proof generation — counter integrity (6 ms)
    ✓ DDOS-001: ReDoS — catastrophic backtracking in sanctions (3 ms)
    ✓ DDOS-002: JSON bomb — deeply nested objects (2 ms)
    ✓ DDOS-003: Large payload — oversized string fields (1 ms)
    ✓ DDOS-004: Hash flooding — bounded Map performance (14 ms)
    ✓ DDOS-005: Proof verification flood — cost asymmetry (42 ms)
    ✓ DDOS-006: Encryption engine — key derivation under load (15 ms)
    ✓ BIZ-001: Negative amount — reverse money flow (5 ms)
    ✓ BIZ-002: Zero amount — fee-only / division-by-zero exploit (4 ms)
    ✓ BIZ-003: Same currency corridor — FX rate must be 1:1 (1 ms)
    ✓ BIZ-004: FX round-trip — no money creation (4 ms)
    ✓ BIZ-005: Fractional cent exploitation — Office Space attack (5033 ms)
    ✓ BIZ-006: TimeLock — cannot execute after expiry (56 ms)
    ✓ BIZ-007: Transaction history persists regardless of tier (7 ms)
    ✓ BIZ-008: Self-payment — sender equals beneficiary (4 ms)
    ✓ CRYPTO2-001: AES-GCM nonce uniqueness — 1000 encryptions (72 ms)
    ✓ CRYPTO2-002: IND-CPA — same plaintext → different ciphertext (6 ms)
    ✓ CRYPTO2-003: Key isolation — cross-context decryption fails (1 ms)
    ✓ CRYPTO2-004: Ed25519 signature malleability resistance (2 ms)
    ✓ CRYPTO2-005: Key isolation — each vault has unique keys regardless of passphrase (1 ms)
    ✓ CRYPTO2-006: Ciphertext tampering — single bit flip detected (1 ms)
    ✓ SERIAL-001: Prototype pollution via __proto__ (1 ms)
    ✓ SERIAL-002: Constructor.prototype pollution (1 ms)
    ✓ SERIAL-003: No eval/Function in deserialization path (2 ms)
    ✓ SERIAL-004: Circular reference handling (1 ms)
    ✓ SERIAL-005: Unicode smuggling in proof claims (2 ms)
    ✓ SUPPLY-001: No eval/Function constructor in codebase (11 ms)
    ✓ SUPPLY-002: No hardcoded secrets in source (11 ms)
    ✓ SUPPLY-003: Only Node.js built-in crypto — no third-party crypto packages (9 ms)
    ✓ META-001: All entry points require authentication context (4 ms)
    ✓ META-002: Cross-layer error propagation — no silent failures (4 ms)
PASS tests/enterprise-3-deep.test.js
    ✓ CS-001: 10,000 encryptions produce unique nonces (195 ms)
    ✓ CS-002: Master key entropy is sufficient (256 bits) (1 ms)
    ✓ CS-003: 100 master keys are all distinct
    ✓ CS-004: HKDF produces different keys for different contexts
    ✓ CS-005: Ed25519 signature is 64 bytes (2 ms)
    ✓ CS-006: Proof signatures are non-deterministic (different per proof) (2 ms)
    ✓ CS-007: AES-GCM auth tag prevents truncation attack (1 ms)
    ✓ CS-008: Different master keys = completely independent encryption spaces
    ✓ CS-009: Timing of encryption is consistent (no timing oracle) (1 ms)
    ✓ CS-010: Concurrent encrypt/decrypt maintains correctness (3 ms)
    ✓ CHAOS-001: System recovers from FX service timeout (17 ms)
    ✓ CHAOS-002: 200 sequential payments from same customer (49 ms)
    ✓ CHAOS-003: Rapid vault create/unlock/lock cycles (21 ms)
    ✓ CHAOS-004: Parallel onboarding stress (50 simultaneous) (36 ms)
    ✓ CHAOS-005: Memory usage after 1000 vault operations (359 ms)
    ✓ CHAOS-006: Encryption engine after 10,000 operations (193 ms)
    ✓ CHAOS-007: Settlement under load (100 payments then settle) (43 ms)
    ✓ CHAOS-008: GC pressure — create and discard 500 vaults (136 ms)
    ✓ REG-PEN001: Key splitting uses Shamir's over GF(256)
    ✓ REG-PEN003: Vault key material cleared on lock (1 ms)
    ✓ REG-PEN600: Proof replay detection (same proof ID rejected) (2 ms)
    ✓ REG-PEN002: Signature verification timing is constant (17 ms)
    ✓ REG-PEN008: Generated keys have sufficient entropy
    ✓ REG-R2-001: Idempotency cache prevents sequential duplicates (12 ms)
    ✓ REG-R2-003: Sub-cent amounts don't generate free money (11 ms)
    ✓ SPEC-001: Proof structure has all required fields (1 ms)
    ✓ SPEC-002: Proof expiry is in the future (1 ms)
    ✓ SPEC-003: Trust node has jurisdiction and operator (1 ms)
    ✓ SPEC-004: Vault ID format is consistent (2 ms)
    ✓ SPEC-005: Node ID format is consistent (4 ms)
    ✓ SPEC-006: Corridor IDs are deterministic
    ✓ SPEC-007: KYC tiers map to correct limits (3 ms)
    ✓ SPEC-008: AML framework returns structured analysis (3 ms)
    ✓ SPEC-009: Payment states follow defined machine (4 ms)
    ✓ SPEC-010: Settlement output includes timestamp (4 ms)
    ✓ SANC-D01: Reversed name order (1 ms)
    ✓ SANC-D02: Added middle name evasion
    ✓ SANC-D03: Initials instead of full name
    ✓ SANC-D04: Diacritical marks evasion (Müller vs Mueller) (1 ms)
    ✓ SANC-D05: Transliteration variants (Cyrillic → Latin)
    ✓ SANC-D06: Title prefix/suffix (Mr., Dr., Gen.) (1 ms)
    ✓ SANC-D07: Unicode homoglyph attack (Cyrillic 'а' vs Latin 'a')
    ✓ SANC-D08: High-risk country codes (1 ms)
    ✓ SANC-D09: Mixed script name
    ✓ SANC-D10: Very similar but innocent name
    ✓ INP-001: Prototype pollution via JSON parse (1 ms)
    ✓ INP-002: Constructor prototype pollution
    ✓ INP-003: RegExp in string fields (3 ms)
    ✓ INP-004: Null bytes in every field (7 ms)
    ✓ INP-005: Path traversal in string fields (7 ms)
    ✓ INP-006: CRLF injection (6 ms)
    ✓ INP-007: Extremely long string in every field (6 ms)
    ✓ INP-008: JSON payload with nested arrays
    ✓ INP-009: Integer overflow in amount (4 ms)
    ✓ INP-010: Type coercion attacks (16 ms)
    ✓ SUP-001: No eval() in source code (8 ms)
    ✓ SUP-002: No Function() constructor (8 ms)
    ✓ SUP-003: No child_process imports (9 ms)
    ✓ SUP-004: No hardcoded API keys or secrets (7 ms)
    ✓ SUP-005: Only built-in crypto module used (21 ms)
    ✓ SUP-006: No TODO/FIXME/HACK in security-critical files (1 ms)
    ✓ SUP-007: All test files import from src/ not node_modules (4 ms)
    ✓ SUP-008: Source files use strict mode or module pattern (8 ms)
    ✓ XC-001: Encryption key context matches KYC data context (1 ms)
    ✓ XC-002: Vault proof accepted only by registered node (1 ms)
    ✓ XC-003: AML analysis gets correct tier from KYC (3 ms)
    ✓ XC-004: Orchestrator routes to correct jurisdiction node (6 ms)
    ✓ XC-005: FX conversion feeds correct amount to payment (9 ms)
    ✓ XC-006: Full pipeline — every component touched (6 ms)
PASS tests/enterprise-3-resilience.test.js
    ✓ CS-001: 100 master keys are all unique (1 ms)
    ✓ CS-002: Master key has sufficient entropy (256 bits) (1 ms)
    ✓ CS-003: Ed25519 key generation produces valid keys (1 ms)
    ✓ CS-004: 50 vaults produce 50 unique key pairs (22 ms)
    ✓ CS-005: AES-GCM nonce uniqueness over 500 encryptions (13 ms)
    ✓ CS-006: Signature verification — 100 proofs all valid (53 ms)
    ✓ CS-007: Bit-flip in signature always detected (8 ms)
    ✓ CS-008: Bit-flip in ciphertext auth tag always detected (1 ms)
    ✓ CS-009: HKDF produces different keys for different purposes (1 ms)
    ✓ CS-010: Cannot construct valid signature without private key (1 ms)
    ✓ CHAOS-001: System recovers after 100 failed operations (6 ms)
    ✓ CHAOS-002: Interleaved success and failure operations (14 ms)
    ✓ CHAOS-003: Memory stability — 500 vault create/destroy cycles (176 ms)
    ✓ CHAOS-004: Concurrent vault operations don't interfere (7 ms)
    ✓ CHAOS-005: Payment engine handles rapid create-cancel cycle (5 ms)
    ✓ CHAOS-006: 10 mesh settlements in rapid succession (5 ms)
    ✓ CHAOS-007: Node registration during settlement (4 ms)
    ✓ CHAOS-008: Encryption under sustained load (44 ms)
    ✓ AUDIT-001: Payment state history records every transition (7 ms)
    ✓ AUDIT-002: Cancelled payment shows cancellation reason (4 ms)
    ✓ AUDIT-003: State history cannot be modified after creation (3 ms)
    ✓ AUDIT-004: Every payment has creation timestamp (3 ms)
    ✓ AUDIT-005: Settlement produces timestamp and summary (4 ms)
    ✓ AUDIT-006: Proof has complete metadata chain (6 ms)
    ✓ ERR-001: Null inputs to every module constructor
    ✓ ERR-002: Undefined inputs to every module constructor (1 ms)
    ✓ ERR-003: Empty object inputs to constructors (1 ms)
    ✓ ERR-004: Encryption with every invalid master key type (1 ms)
    ✓ ERR-005: Decrypt with every invalid ciphertext format (1 ms)
    ✓ ERR-006: Vault operations in wrong order
    ✓ ERR-007: Payment engine operations on nonexistent ID (3 ms)
    ✓ ERR-008: KYC with every invalid customer data shape (4 ms)
    ✓ ERR-009: AML with edge-case transaction shapes (5 ms)
    ✓ ERR-010: Sanctions screener with extreme inputs (4 ms)
    ✓ REGR-001: Vault uses GF(256) Shamir, not XOR splitting (1 ms)
    ✓ REGR-002: Master key zeroed after vault lock (1 ms)
    ✓ REGR-003: UUID generation has sufficient entropy (5 ms)
    ✓ REGR-004: Proof signature covers canonical payload (1 ms)
    ✓ REGR-005: Proof rate limit prevents abuse (3 ms)
    ✓ REGR-006: FX conversion doesn't round up for customer (6 ms)
    ✓ REGR-007: Signature verification is constant-time (11 ms)
    ✓ REGR-008: Proof replay detection via bounded set (3 ms)
    ✓ JURIS-001: 5-node mesh — DE to SG via FR (indirect routing) (3 ms)
    ✓ JURIS-002: Each node reports its jurisdiction correctly (4 ms)
    ✓ JURIS-003: Proof is jurisdiction-scoped (includes node ID) (1 ms)
    ✓ JURIS-004: 10-jurisdiction mesh creates all 45 corridors (4 ms)
    ✓ JURIS-005: Settlement between 2 specific nodes (3 ms)
    ✓ JURIS-006: Customer onboarding sets correct home jurisdiction (8 ms)
    ✓ SRC-001: No eval() in source code (25 ms)
    ✓ SRC-002: No Function() constructor in source (10 ms)
    ✓ SRC-003: No child_process in source (10 ms)
    ✓ SRC-004: No hardcoded private keys (11 ms)
    ✓ SRC-005: No hardcoded API keys or tokens (10 ms)
    ✓ SRC-006: No console.log in production source (except logger) (9 ms)
    ✓ SRC-007: All crypto uses Node.js built-in module (12 ms)
    ✓ SRC-008: No TODO/FIXME/HACK comments in security-critical files (4 ms)
      ✓ MITIGATED: Ciphertext tampering (GCM auth tag)
      ✓ MITIGATED: IV uniqueness (cryptographic random)
      ✓ MITIGATED: Cross-purpose decryption (derived keys)
      ✓ MITIGATED: Record swapping (AAD context binding)
      ✓ Fixed from v1: Zero-width chars stripped
      ✓ Fixed from v1: Title prefixes stripped
      ✓ NEW: Cyrillic/Arabic transliteration
      ✓ NEW: Phonetic matching (Double Metaphone)
      ✓ MITIGATED: PII encrypted at rest (AES-256-GCM)
      ✓ MITIGATED: Monthly volume limits enforced
      ✓ WORKING: Structuring detection (≥3 txns, >50% threshold, >2x total)
      ✓ WORKING: High-risk corridor blocking
      ✓ WORKING: Auto SAR draft generation
      ✓ BY DESIGN: Auto-revert uses pre-selected fallback
PASS tests/adversarial-v2.test.js
    ✓ VULN-050: Tampering with ciphertext is detected (19 ms)
    ✓ VULN-051: IV reuse detection (178 ms)
    ✓ VULN-052: Cross-purpose decryption blocked (2 ms)
    ✓ VULN-053: Context binding prevents record swapping
    ✓ VULN-054: Timing attack on hash comparison (34 ms)
    ✓ VULN-055: Master key in memory exposure (5 ms)
    ✓ VULN-056: Encrypted data size leaks plaintext length (3 ms)
    ✓ VULN-060: Homoglyph attack with Cyrillic characters (2 ms)
    ✓ VULN-061: Name with extra middle names
    ✓ VULN-062: Entity name with unicode confusables
    ✓ VULN-063: Name split across sender and reference fields (2 ms)
    ✓ VULN-064: Arabic name with different diacritics (3 ms)
    ✓ VULN-065: Performance with large sanctions list simulation (264 ms)
    ✓ VULN-070: Identity spoofing with special characters (2 ms)
    ✓ VULN-071: TIER_1 customer exceeding limits via many small transactions
    ✓ VULN-072: Fake document number format (2 ms)
    ✓ VULN-073: Multiple accounts with same person, different email (2 ms)
    ✓ VULN-080: Structuring just below detection threshold (1 ms)
    ✓ VULN-081: Currency layering with only 2 pairs (1 ms)
    ✓ VULN-082: Round tripping with 6% amount difference (1 ms)
    ✓ VULN-083: Using multiple beneficiaries to hide volume (2 ms)
    ✓ VULN-090 FIX: Immediate cancel blocked by 48-hour lock-in (9 ms)
    ✓ VULN-090 FIX: Non-refundable contract fee charged at creation (4 ms)
    ✓ VULN-091 FIX: Daily contract limit blocks spray-and-pray (2 ms)
    ✓ VULN-091 FIX: TRUSTED tier allows up to 5 per day (11 ms)
    ✓ VULN-092 FIX: Derivative probability sealed — never in client response (3 ms)
    ✓ VULN-093: Break-even rate manipulation via timing (3 ms)
    ✓ VULN-094: Expired contract auto-reverts without user consent (2 ms)
    ✓ VULN-095 FIX: Derivative value hidden even with extreme inputs (3 ms)
    ✓ Full Report (27 ms)
PASS tests/adversarial.test.js
    ✓ VULN-001: IBAN with unicode digits (1 ms)
    ✓ VULN-002: IBAN with leading/trailing whitespace (1 ms)
    ✓ VULN-003: Valid checksum but impossible BBAN (5 ms)
    ✓ VULN-004: IBAN from sanctioned country still validates (1 ms)
    ✓ VULN-005: Extremely long input to IBAN validator (1 ms)
    ✓ VULN-006: Null bytes in IBAN
    ✓ VULN-010: Name with zero-width characters (1 ms)
    ✓ VULN-011: Name with mixed scripts (3 ms)
    ✓ VULN-012: Name reversed (7 ms)
    ✓ VULN-013: Name with title/honorific (1 ms)
    ✓ VULN-014: Name with middle name/initial (1 ms)
    ✓ VULN-015: Partial name only (2 ms)
    ✓ VULN-016: Entity name with legal suffix variations (3 ms)
    ✓ VULN-017: Name transliteration from non-Latin (2 ms)
    ✓ VULN-018: Sanctions screening performance under load (385 ms)
    ✓ VULN-020: Floating point precision in conversion
    ✓ VULN-021: Negative amount in conversion (2 ms)
    ✓ VULN-022: Extremely small amounts (dust attacks) (2 ms)
    ✓ VULN-023: FX markup inversion attack (2 ms)
    ✓ VULN-024: Rounding direction exploit (3 ms)
    ✓ VULN-025: FX rate of 0 (2 ms)
    ✓ VULN-026: Same currency conversion exploit (1 ms)
    ✓ VULN-030: Double-spend via state race condition (2 ms)
    ✓ VULN-031: Quote expiry race condition (2 ms)
    ✓ VULN-032: Replay attack on idempotency key (1 ms)
    ✓ VULN-033: State history tampering via JSONB (2 ms)
    ✓ VULN-040: SQL injection via payment purpose (1 ms)
    ✓ VULN-041: XSS in webhook URL (1 ms)
    ✓ VULN-042: SSRF via webhook URL (3 ms)
    ✓ VULN-043: JSON prototype pollution in sender object (2 ms)
    ✓ VULN-044: Oversized JSONB payload (69 ms)
    ✓ Print report (23 ms)
PASS tests/enterprise-2-chains.test.js
    ✓ TL-001: Calculate options returns multiple tiers (8 ms)
    ✓ TL-002: Create contract with valid parameters (6 ms)
    ✓ TL-003: Cannot activate expired contract (3 ms)
    ✓ TL-004: Contract status reflects accurate state (5 ms)
    ✓ TL-005: Cancel contract returns locked funds (4 ms)
    ✓ TL-006: Negative lock duration rejected (4 ms)
    ✓ TL-007: Zero amount contract rejected (11 ms)
    ✓ TL-008: Massive amount contract handled (6 ms)
    ✓ MESH-001: Cannot add duplicate node to mesh
    ✓ MESH-002: Cannot open corridor to non-existent node (1 ms)
    ✓ MESH-003: Corridor is bidirectional (1 ms)
    ✓ MESH-004: No route between disconnected nodes (1 ms)
    ✓ MESH-005: Settlement produces valid records (4 ms)
    ✓ MESH-006: Mesh handles 20+ nodes without degradation (8 ms)
    ✓ MESH-007: Self-corridor (node to itself) handled (1 ms)
    ✓ MESH-008: Route finding with single hop
    ✓ MESH-009: Empty mesh returns no routes (1 ms)
    ✓ MESH-010: Multiple settlements don't corrupt state (7 ms)
    ✓ NODE-001: Unregistered vault proof rejected (2 ms)
    ✓ NODE-002: Wrong KYC tier blocks high-value payment (2 ms)
    ✓ NODE-003: Commitment signature is cryptographically valid (1 ms)
    ✓ NODE-004: Tampered commitment rejected by receiver (2 ms)
    ✓ NODE-005: Node jurisdiction is immutable after creation (1 ms)
    ✓ NODE-006: Node tracks commitment count correctly (4 ms)
    ✓ VAULT-001: Stored identity never appears in proof output (1 ms)
    ✓ VAULT-002: Identity commitment is deterministic for same data (1 ms)
    ✓ VAULT-003: Vault ID is a valid UUID (1 ms)
    ✓ VAULT-004: Proof counter never resets (1 ms)
    ✓ VAULT-005: Multiple identities in same vault handled
    ✓ VAULT-006: Signing key pair is Ed25519 (1 ms)
    ✓ VAULT-007: Each vault gets unique signing keys (5 ms)
    ✓ VAULT-008: Proof signature verification with static method (1 ms)
    ✓ VAULT-009: Bit-flipped proof fails verification (2 ms)
    ✓ VAULT-010: Proof with modified claims fails verification (1 ms)
    ✓ FX-001: Rate is always positive (13 ms)
    ✓ FX-002: Spread is always non-negative (5 ms)
    ✓ FX-003: Conversion preserves value within spread tolerance (2 ms)
    ✓ FX-004: Same-currency conversion is identity
    ✓ FX-005: Micro-amount conversion doesn't produce zero (2 ms)
    ✓ FX-006: Rate consistency — A→B → B→A ≈ 1/rate (4 ms)
    ✓ FX-007: Large amount conversion preserves precision (5 ms)
    ✓ FX-008: Unsupported currency pair throws or returns error
    ✓ FX-009: Rate caching produces consistent results (3 ms)
    ✓ FX-010: All quote metadata present (2 ms)
    ✓ CHAIN-001: Onboard → Pay → Verify end-to-end integrity (8 ms)
    ✓ CHAIN-002: Multiple customers → concurrent payments → no cross-contamination (17 ms)
    ✓ CHAIN-003: Pay to every jurisdiction from same customer (13 ms)
    ✓ CHAIN-004: Rapid idempotent retries produce single payment (8 ms)
    ✓ CHAIN-005: Customer from high-risk country gets enhanced scrutiny (5 ms)
    ✓ CHAIN-006: Settlement after multiple payments reflects all (14 ms)
    ✓ CHAIN-007: getCustomerStatus returns all expected fields (4 ms)
    ✓ CHAIN-008: Nonexistent customer payment fails gracefully (3 ms)
    ✓ CHAIN-009: Nonexistent receiver node handled without crash (6 ms)
    ✓ CHAIN-010: Payment with every currency pair (13 ms)
    ✓ PE-001: Create payment with all required fields (3 ms)
    ✓ PE-002: Missing sender rejected (3 ms)
    ✓ PE-003: Missing beneficiary rejected (4 ms)
    ✓ PE-004: Missing amount defaults or rejected (3 ms)
    ✓ PE-005: Missing currency defaults or rejected (4 ms)
    ✓ PE-006: Sanctioned beneficiary detected in pipeline (3 ms)
    ✓ PE-007: Invalid IBAN format caught at validation (3 ms)
    ✓ PE-008: Quote contains rate information (3 ms)
    ✓ PE-009: Double-validate same payment is safe (3 ms)
    ✓ PE-010: Full happy path timing is under 1000ms (5 ms)
    ✓ GDPR-001: Right to erasure — vault can be destroyed (1 ms)
    ✓ GDPR-002: Proof contains no PII even after identity update (2 ms)
    ✓ GDPR-003: Cross-border proof reveals only jurisdiction, not address (1 ms)
    ✓ GDPR-004: Encrypted PII uses HKDF context separation (1 ms)
    ✓ AML-COMPLY-001: Travel Rule — payment tracks sender jurisdiction (7 ms)
    ✓ AML-COMPLY-002: Reporting threshold boundary — exactly €10,000 (4 ms)
    ✓ EDGE-001: Payment to same jurisdiction (DE→DE) (4 ms)
    ✓ EDGE-002: Zero amount payment handled without crash (7 ms)
    ✓ EDGE-003: Negative amount payment rejected (4 ms)
    ✓ EDGE-004: Very small amount (0.01) (9 ms)
    ✓ EDGE-005: Very large amount (€999,999) (3 ms)
    ✓ EDGE-006: Purpose field with special characters (31 ms)
    ✓ EDGE-007: Beneficiary name with SQL injection attempt (17 ms)
    ✓ EDGE-008: XSS in every user-facing string field (3 ms)
    ✓ EDGE-009: Unicode normalization — equivalent strings (3 ms)
    ✓ EDGE-010: Concurrent onboard + pay race (8 ms)
PASS tests/enterprise-4-exhaustive.test.js
    ✓ JUR-001: Every corridor pair produces a valid corridor ID (6 ms)
    ✓ JUR-002: DE→SG corridor payment (9 ms)
    ✓ JUR-003: US→FR corridor payment (8 ms)
    ✓ JUR-004: NL→US corridor payment (13 ms)
    ✓ JUR-005: Same customer pays to 4 different jurisdictions (14 ms)
    ✓ JUR-006: High-risk corridor (any→KP) blocked (4 ms)
    ✓ JUR-007: Node jurisdictions are ISO 3166-1 alpha-2 (6 ms)
    ✓ JUR-008: 15-node mesh settles correctly (8 ms)
    ✓ ERR-001: Decrypt with corrupted ciphertext (every byte position) (1 ms)
    ✓ ERR-002: Vault unlock with every bad type (2 ms)
    ✓ ERR-003: Generate proof without stored identity (1 ms)
    ✓ ERR-004: Payment engine — validate nonexistent payment (3 ms)
    ✓ ERR-005: Payment engine — screen nonexistent payment (3 ms)
    ✓ ERR-006: Payment engine — quote nonexistent payment (4 ms)
    ✓ ERR-007: Payment engine — confirm nonexistent payment (3 ms)
    ✓ ERR-008: Payment engine — process nonexistent payment (3 ms)
    ✓ ERR-009: Payment engine — cancel nonexistent payment (5 ms)
    ✓ ERR-010: FX convert with invalid currencies
    ✓ ERR-011: FX getRate with invalid currencies (1 ms)
    ✓ ERR-012: Encryption of non-string types
    ✓ ERR-013: Decryption of null/undefined (1 ms)
    ✓ ERR-014: KYC with missing customer data fields (5 ms)
    ✓ ERR-015: AML with malformed transaction (3 ms)
    ✓ INT-001: Payment ID is UUID format (3 ms)
    ✓ INT-002: Stored payment matches created payment (4 ms)
    ✓ INT-003: State transitions are recorded with timestamps (3 ms)
    ✓ INT-004: Encrypted data round-trips perfectly for every data type (2 ms)
    ✓ INT-005: Customer vault mapping is 1:1 (12 ms)
    ✓ INT-006: Proof nonce uniqueness across vaults (5 ms)
    ✓ INT-007: FX rates are symmetric within spread (14 ms)
    ✓ INT-008: Settlement is idempotent (3 ms)
    ✓ PERF-001: Vault unlock < 50ms (7 ms)
    ✓ PERF-002: Proof generation < 10ms (5 ms)
    ✓ PERF-003: Proof verification < 5ms (9 ms)
    ✓ PERF-004: Encryption < 1ms per operation (4 ms)
    ✓ PERF-005: Sanctions screening < 10ms per name (2 ms)
    ✓ PERF-006: Onboarding < 100ms (9 ms)
    ✓ PERF-007: Full payment pipeline < 200ms (8 ms)
    ✓ PERF-008: Settlement < 50ms for 10 corridors (3 ms)
    ✓ NEG-001: SovereignVault constructor with bad options (1 ms)
    ✓ NEG-002: TrustNode constructor with missing fields (1 ms)
    ✓ NEG-003: TrustMesh addNode with null
    ✓ NEG-004: EncryptionEngine with bad master key
    ✓ NEG-005: KYC checkTransactionLimits with bad tier (3 ms)
    ✓ NEG-006: AML analyzeTransaction with null customer (4 ms)
    ✓ NEG-007: FX getRate with same currency
    ✓ NEG-008: FX convert with zero amount (3 ms)
    ✓ NEG-009: FX convert with negative amount (2 ms)
    ✓ NEG-010: TimeLock calculateOptions with bad currency (4 ms)
    ✓ NEG-011: Orchestrator with missing dependencies
    ✓ NEG-012: Verify proof with null input (1 ms)
    ✓ NEG-013: Verify proof with empty payload
    ✓ NEG-014: Store identity with missing fields (1 ms)
    ✓ NEG-015: Generate proof with bad type (2 ms)
    ✓ TAM-001: Payment state history cannot be truncated (4 ms)
    ✓ TAM-002: Proof signature covers all payload fields (3 ms)
    ✓ TAM-003: Corridor state reflects actual operations (4 ms)
    ✓ TAM-004: Encryption ciphertext format is versioned
    ✓ TAM-005: Vault public key matches proof public key (1 ms)
    ✓ TAM-006: Commitment chain ordering verified (2 ms)
    ✓ CONC-001: 5 customers × 3 payments each = 15 concurrent (35 ms)
    ✓ CONC-002: Parallel vault unlocks don't interfere (6 ms)
    ✓ CONC-003: Parallel proof generations don't share state (3 ms)
    ✓ CONC-004: Parallel encryptions produce unique ciphertexts (2 ms)
    ✓ REG-001: PEN-001 — XOR key splitting replaced by Shamir's
    ✓ REG-002: PEN-003 — Master key zeroed on vault lock (1 ms)
    ✓ REG-003: PEN-008 — Shannon entropy check on proofs (2 ms)
    ✓ REG-004: VULN-R2-003 — Sub-cent amounts produce bounded FX (5 ms)
    ✓ REG-005: RACE-001 — Idempotency key prevents duplicates (sequential) (7 ms)
    ✓ REG-006: HKDF key derivation uses per-vault salt (1 ms)
    ✓ REG-007: Ed25519 signatures are deterministic per payload (1 ms)
    ✓ REG-008: Cross-layer PII containment — orchestrator never leaks (7 ms)
PASS tests/v2.test.js
    ✓ encrypts and decrypts plaintext (1 ms)
    ✓ encrypted output is not plaintext
    ✓ same plaintext produces different ciphertext (unique IV) (1 ms)
    ✓ context binding prevents cross-record swaps (18 ms)
    ✓ wrong purpose key fails decryption (1 ms)
    ✓ field-level encryption on object (4 ms)
    ✓ HMAC hash is deterministic
    ✓ different salts produce different hashes (1 ms)
    ✓ rejects invalid master key length
    ✓ handles empty string encryption (1 ms)
    ✓ handles unicode in plaintext
    ✓ exact match on primary name
    ✓ exact match on alias
    ✓ matches name with title prefix stripped
    ✓ matches name with military title (1 ms)
    ✓ KNOWN GAP: YVAN → IVAN phonetic match (5 ms)
    ✓ catches French transliteration: PIETROV → PETROV
    ✓ matches Cyrillic name via transliteration (1 ms)
    ✓ matches Arabic name via transliteration
    ✓ catches Arabic transliteration variant (1 ms)
    ✓ matches entity with different legal suffix
    ✓ catches reversed name order (1 ms)
    ✓ clears clean name
    ✓ clears clean entity (1 ms)
    ✓ strips zero-width characters before matching (1 ms)
    ✓ flags high-risk jurisdiction
    ✓ flags monitored jurisdiction
    ✓ screens full payment with corridor risk (1 ms)
    ✓ screens 1000 names in under 2 seconds (60 ms)
    ✓ onboards customer with basic verification (1 ms)
    ✓ blocks customer matching sanctions (1 ms)
    ✓ rejects missing required fields
    ✓ encrypts PII in customer profile (1 ms)
    ✓ validates document submission
    ✓ rejects expired document (1 ms)
    ✓ checks transaction limits for tier
    ✓ risk score elevates for monitored jurisdiction (1 ms)
    ✓ detects structuring (smurfing) (1 ms)
    ✓ detects high-risk corridor
    ✓ detects currency layering (1 ms)
    ✓ flags threshold reporting
    ✓ passes clean transaction
    ✓ generates SAR draft when required (1 ms)
    ✓ calculates three fee tier options (2 ms)
    ✓ creates TimeLock contract with correct terms (3 ms)
    ✓ activates contract and starts monitoring (3 ms)
    ✓ executes contract when break-even reached (2 ms)
    ✓ expires contract and triggers fallback (1 ms)
    ✓ cancels contract and reverts to chosen tier (2 ms)
    ✓ derivative profile is sealed but accessible via internal method (3 ms)
    ✓ rejects invalid fallback tier (5 ms)
    ✓ break-even rate is higher than entry rate (2 ms)
PASS tests/penetration.test.js
    ✓ PEN-001: Recovery key — verify actual 2-of-3 threshold (Shamir) (30 ms)
    ✓ PEN-002: Proof signature timing — verify before expiry check (2 ms)
    ✓ PEN-003: Vault master key memory exposure — key wiped between ops (1 ms)
    ✓ PEN-004: Proof rate limiting — prevent proof flooding (3 ms)
    ✓ PEN-005: HKDF salt — verify non-deterministic per engine instance (3 ms)
    ✓ PEN-006: Ed25519 key determinism — same passphrase = same keypair (5 ms)
    ✓ PEN-007: JSON serialization order — proof verification cross-platform (1 ms)
    ✓ PEN-008: Passphrase entropy — reject low-entropy passphrases (2 ms)
    ✓ PEN-100: Commitment chain — verify node signature, not just hashes (4 ms)
    ✓ PEN-101: Commitment replay on receiver side (3 ms)
    ✓ PEN-102: Counter correlation across trust nodes (1 ms)
    ✓ PEN-103: Duplicate identity registration (multi-vault bypass) (2 ms)
    ✓ PEN-104: Foreign regulator access — strict jurisdiction enforcement (1 ms)
    ✓ PEN-105: Expired commitment acceptance (1 ms)
    ✓ PEN-200: Bilateral netting — tracks amounts, not just counts (1 ms)
    ✓ PEN-201: Float precision in FX — minor unit arithmetic
    ✓ PEN-202: TimeLock break-even manipulation — verify rate math (3 ms)
    ✓ PEN-203: KYC tier bypass — verify tier limits enforced (3 ms)
    ✓ PEN-204: AML structuring detection — just-below-threshold (1 ms)
    ✓ PEN-205: Amount commitment range — verify range accuracy (3 ms)
    ✓ PEN-300: SQL injection in payment fields (1 ms)
    ✓ PEN-301: XSS in memo/purpose fields (1 ms)
    ✓ PEN-302: Prototype pollution via identity data (1 ms)
    ✓ PEN-303: Unicode normalization in sanctions screening (3 ms)
    ✓ PEN-304: Oversized payload in identity storage (1 ms)
    ✓ PEN-305: IBAN with special characters — no crash on malformed input (1 ms)
    ✓ PEN-400: State machine — no skipping states (11 ms)
    ✓ PEN-401: Double-processing — idempotency check (3 ms)
    ✓ PEN-402: Cancel from non-cancellable state (8 ms)
    ✓ PEN-403: Concurrent proof generation — counter atomicity (5 ms)
    ✓ PEN-500: Proof contains absolutely ZERO PII (3 ms)
    ✓ PEN-501: Error messages don't leak internal state (1 ms)
    ✓ PEN-502: Vault ID is not correlatable to identity (2 ms)
    ✓ PEN-503: Audit log doesn't contain PII (5 ms)
    ✓ PEN-504: Settlement data doesn't reveal individual transactions (2 ms)
    ✓ PEN-600: Seen proof IDs set — bounded size with LRU eviction (1 ms)
    ✓ PEN-601: Session key tracking — verify cleanup (2 ms)
    ✓ PEN-602: Key zeroing on lock — verify memory is actually cleared (1 ms)
    ✓ PEN-603: Commitment chain — no unbounded growth in test env (2 ms)
    ✓ PEN-700: Vault operations require unlock — all paths checked (3 ms)
    ✓ PEN-701: Brute-force lockout — exponential backoff (3 ms)
    ✓ PEN-702: Proof requires registered vault on trust node (2 ms)
    ✓ PEN-703: Public key mismatch — stolen proof rejected (3 ms)
    ✓ PEN-704: Recipient binding — proof only valid for intended node (3 ms)
    ✓ All vulnerability categories covered (1 ms)
PASS tests/integration.test.js
    ✓ INT-001: Full lifecycle — onboard → pay → settle (13 ms)
    ✓ INT-002: KYC limit enforcement blocks oversized payment (5 ms)
    ✓ INT-003: AML blocks high-risk corridor payment (4 ms)
    ✓ INT-004: Sanctions match blocks at onboarding (7 ms)
    ✓ INT-005: Multiple payments accumulate in AML history (14 ms)
    ✓ INT-006: TimeLock payment runs compliance then creates contract (10 ms)
    ✓ INT-007: Mesh topology visible and verifiable (3 ms)
    ✓ INT-008: Chain integrity verifiable after payment (8 ms)
    ✓ INT-009: Unknown customer rejected (3 ms)
    ✓ INT-010: Full flow — proof contains ZERO PII even with rich identity (9 ms)
    ✓ INT-011: Orchestrator has all 5 layer references (3 ms)
    ✓ INT-012: Single payment touches all 5 layers (10 ms)
PASS tests/protocol.test.js
    ✓ unlock vault with passphrase (1 ms)
    ✓ rejects short passphrase (23 ms)
    ✓ store and read identity (PII stays on device) (1 ms)
    ✓ identity is encrypted at rest (1 ms)
    ✓ generate Sovereign Proof with zero PII (2 ms)
    ✓ verify Sovereign Proof (static method) (2 ms)
    ✓ tampered proof fails verification (1 ms)
    ✓ expired proof fails verification (2 ms)
    ✓ session keys are destroyed after proof generation (2 ms)
    ✓ vault lock zeros all keys from memory (1 ms)
    ✓ locked vault rejects operations (4 ms)
    ✓ proof counter is monotonically increasing (2 ms)
    ✓ recovery key is split into 3 shares (1 ms)
    ✓ node initialization (2 ms)
    ✓ register vault on home jurisdiction node (1 ms)
    ✓ connect two peer nodes (1 ms)
    ✓ process outbound payment with valid proof (3 ms)
    ✓ reject proof with failed KYC attestation (2 ms)
    ✓ replay protection rejects duplicate proof (3 ms)
    ✓ commitment chain integrity (4 ms)
    ✓ bilateral settlement netting (3 ms)
    ✓ regulator audit returns local data only (1 ms)
    ✓ build mesh with corridors (1 ms)
    ✓ full cross-border payment through mesh (DE → SG) (3 ms)
    ✓ verify chain integrity through mesh (6 ms)
    ✓ mesh-wide settlement (8 ms)
    ✓ find route through intermediary nodes (1 ms)
    ✓ no route returns null (1 ms)
    ✓ VULN-100: PII never in proof payload (2 ms)
    ✓ VULN-101: Forged proof rejected (2 ms)
    ✓ VULN-102: Counter regression attack blocked (2 ms)
    ✓ VULN-103: Foreign regulator cannot access local PII (1 ms)
    ✓ VULN-104: Unregistered vault rejected (2 ms)
PASS tests/core.test.js
    ✓ validates correct German IBAN (1 ms)
    ✓ validates correct British IBAN (1 ms)
    ✓ validates correct French IBAN
    ✓ validates correct Dutch IBAN
    ✓ validates correct Spanish IBAN
    ✓ rejects IBAN with bad checksum
    ✓ rejects IBAN with wrong length
    ✓ rejects IBAN with invalid country
    ✓ rejects empty input
    ✓ handles IBAN without spaces (1 ms)
    ✓ extracts bank identifier
    ✓ validates 8-char SWIFT code
    ✓ validates 11-char SWIFT code (1 ms)
    ✓ rejects invalid length
    ✓ rejects numeric bank code
    ✓ identifies test BIC
    ✓ converts to minor units (EUR)
    ✓ handles zero-decimal currencies (JPY) (1 ms)
    ✓ handles 3-decimal currencies (BHD)
    ✓ round-trips without precision loss
    ✓ validates currency codes
    ✓ formats amounts correctly (14 ms)
    ✓ applies markup in basis points (1 ms)
    ✓ throws on unknown currency (11 ms)
    ✓ exact match returns high confidence (1 ms)
    ✓ fuzzy match catches transliterations (1 ms)
    ✓ clears non-sanctioned names (1 ms)
    ✓ screens both payment parties (1 ms)
    ✓ handles unicode normalization (1 ms)
    ✓ handles empty name gracefully
    ✓ case insensitive matching (1 ms)
    ✓ returns screening duration (1 ms)
    ✓ all states have defined transitions
    ✓ terminal states have no outgoing transitions (4 ms)
    ✓ FAILED can retry to INITIATED
    ✓ HELD can clear to SCREENED or reject
    ✓ happy path is valid (1 ms)
    ✓ no state can transition to INITIATED except FAILED (1 ms)
Test Suites: 15 passed, 15 total
Tests:       764 passed, 764 total
---
Generated: 2026-02-06T01:10:24Z
